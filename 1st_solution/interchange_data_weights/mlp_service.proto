syntax = "proto3";

package mlp;

// Service definition
service MLPExchange {
  // Exchange Model Weights
  rpc SendWeights (WeightUpdate) returns (Ack) {}
  
  // Exchange Training Data
  rpc SendData (DataBatch) returns (Ack) {}
}

// A single tensor (NumPy array) serialization
message NDArray {
  bytes data = 1;       // Raw byte data of the array
  repeated int32 shape = 2; // Shape dimensions
  string dtype = 3;     // Data type (e.g., "float32")
}

message WeightUpdate {
  string sender_id = 1;
  repeated NDArray weights = 2; // A list of arrays (layers)
  int32 step = 3;
}

message DataBatch {
  string sender_id = 1;
  NDArray features = 2;
  NDArray labels = 3;
}

message Ack {
  bool success = 1;
  string message = 2;
}
